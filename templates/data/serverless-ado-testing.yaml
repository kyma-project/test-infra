templates:
  # temporary testing jobs for transition to ADO
  - from: generic.tmpl
    render:
      - to: ../../prow/jobs/kyma-project/serverless/serverless-build-ado.yaml
        localSets:
          skip_if_only_changed_documentation:
            skip_if_only_changed: '^docs/|^examples/'
          default:
            optional: true
            labels:
              preset-image-builder-ado-token: "true"
            branches:
              - main
              - release-*
        jobConfigs:
          - repoName: kyma-project/serverless
            jobs:
              - jobConfig:
                  name: pre-serverless-operator-build-ado
                  image: "europe-docker.pkg.dev/kyma-project/prod/image-builder:v20240424-ba8cae9d"
                  annotations:
                    owner: otters
                    description: serverless operator image build
                  command: /image-builder
                  args:
                    - --name=serverless-operator-ado
                    - --config=/config/kaniko-build-config.yaml
                    - --context=.
                    - --dockerfile=components/operator/Dockerfile
                    - --build-arg=PURPOSE=dev
                    - --build-arg=IMG_DIRECTORY=dev
                    - --build-arg=IMG_VERSION=PR-$(PULL_NUMBER)
                    - "--build-in-ado=true"
                inheritedConfigs:
                  global:
                    - jobConfig_presubmit
                    - image-builder-buildkit
                  local:
                    - skip_if_only_changed_documentation
                    - default
