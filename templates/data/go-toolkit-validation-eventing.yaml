templates:
  - from: generic.tmpl
    render:
      - to: ../../prow/jobs/kyma/components/event-publisher-proxy/event-publisher-proxy-checks.yaml
        localSets:
          linting:
            skip_report: "false"
            max_concurrency: "10"
            optional: "true"
            decorate: "true"
            image: "eu.gcr.io/kyma-project/test-infra/golangci-lint:v20221025-25ddc121"
            pubsub_project: "sap-kyma-prow"
            pubsub_topic: "prowjobs"
            request_memory: 200Mi
            request_cpu: 80m
          testing:
            skip_report: "false"
            max_concurrency: "10"
            optional: "true"
            decorate: "true"
            image: "eu.gcr.io/kyma-project/test-infra/buildpack-golang:v20221215-c20ffd65"
            pubsub_project: "sap-kyma-prow"
            pubsub_topic: "prowjobs"
            request_memory: 1Gi
            request_cpu: 100m
        jobConfigs:
          - repoName: "kyma-project/kyma"
            jobs:
              - jobConfig:
                  name: "pull-event-publisher-proxy-lint"
                  optional: false
                  command: "/bin/sh"
                  args:
                    - "-c"
                    - "cd components/event-publisher-proxy && golangci-lint run --new-from-rev=$PULL_BASE_SHA ./... --timeout=10m"
                  run_if_changed: '^components/event-publisher-proxy/(.*\.go$|.golangcilint.yaml)'
                inheritedConfigs:
                  global:
                    - "jobConfig_presubmit"
                  local:
                    - linting
              - jobConfig:
                  name: "pull-event-publisher-proxy-unit-test"
                  optional: false
                  command: "/bin/sh"
                  args:
                    - "-c"
                    - "cd components/event-publisher-proxy && go test -coverprofile=$ARTIFACTS/filtered.cov ./..."
                  run_if_changed: '^components/event-publisher-proxy/.*$'
                inheritedConfigs:
                  global:
                    - "jobConfig_presubmit"
                  local:
                    - testing
      - to: ../../prow/jobs/kyma/components/eventing-controller/eventing-controller-checks.yaml
        localSets:
          linting:
            skip_report: "false"
            max_concurrency: "10"
            optional: "true"
            decorate: "true"
            image: "eu.gcr.io/kyma-project/test-infra/golangci-lint:v20221025-25ddc121"
            pubsub_project: "sap-kyma-prow"
            pubsub_topic: "prowjobs"
            request_memory: 200Mi
            request_cpu: 80m
          testing:
            skip_report: "false"
            max_concurrency: "10"
            optional: "true"
            decorate: "true"
            image: "eu.gcr.io/kyma-project/test-infra/buildpack-golang:v20221215-c20ffd65"
            pubsub_project: "sap-kyma-prow"
            pubsub_topic: "prowjobs"
            request_memory: 1Gi
            request_cpu: 100m
        jobConfigs:
          - repoName: "kyma-project/kyma"
            jobs:
              - jobConfig:
                  name: "pull-eventing-controller-lint"
                  optional: false
                  command: "/bin/sh"
                  args:
                    - "-c"
                    - "cd components/eventing-controller && golangci-lint run --new-from-rev=$PULL_BASE_SHA ./... --timeout=10m"
                  run_if_changed: '^components/eventing-controller/(.*\.go$|.golangcilint.yaml)'
                inheritedConfigs:
                  global:
                    - "jobConfig_presubmit"
                  local:
                    - linting
              - jobConfig:
                  name: "pull-eventing-controller-unit-test"
                  optional: false
                  command: "/bin/sh"
                  args:
                    - "-c"
                    - "cd components/eventing-controller && KUBEBUILDER_CONTROLPLANE_START_TIMEOUT=50s go test -coverprofile=$ARTIFACTS/filtered.cov ./..."
                  run_if_changed: '^components/eventing-controller/.*$'
                inheritedConfigs:
                  global:
                    - "jobConfig_presubmit"
                  local:
                    - testing
