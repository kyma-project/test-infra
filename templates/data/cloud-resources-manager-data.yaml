templates:
  - from: generic.tmpl
    render:
      - to: ../../prow/jobs/kyma-project/cloud-resources-manager/cloud-resources-manager-build.yaml
        jobConfigs:
          - repoName: kyma-project/test-infra
            jobs:
              - jobConfig: # builds a docker image of the btp-manager tagged with the PR name
                  name: pull-cloud-resource-manager-kcp-image
                  annotations:
                    description: "build cloud-resources-manager kcp image"
                    owner: "phoenix"
                  run_if_changed: ^components/.*.go|go.mod
                  command:
                    - "/image-builder"
                  args:
                    - "--name=cloud-resources-manager"
                    - "--config=/config/kaniko-build-config.yaml"
                    - "--context=."
                    - "--dockerfile=components/kcp/Dockerfile"
                    - "--build-in-ado=true"
                  labels:
                    preset-sa-kyma-push-images: "true" 
                inheritedConfigs:
                  global:
                    - kaniko_buildpack
                    - jobConfig_presubmit