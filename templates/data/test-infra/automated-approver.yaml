templates:
  - from: generic.tmpl
    render:
      - to: ../../prow/jobs/test-infra/automated-approver.yaml
        jobConfigs:
          - repoName: "github.com/kyma-project/test-infra"
            jobs:
              - jobConfig:
                  name: "pull-build-image-automated-approver"
                  annotations:
                    description: "Builds the image for the automated-approver plugin."
                    owner: "neighbors"
                  run_if_changed: '^development/external-plugins/automated-approver'
                  args:
                    - "--name=test-infra/automated-approver"
                    - "--config=/config/kaniko-build-config.yaml"
                    - "--context=."
                    - "--dockerfile=development/external-plugins/automated-approver/Dockerfile"
                inheritedConfigs:
                  global:
                    - "kaniko_buildpack"
                    - "jobConfig_presubmit"
              - jobConfig:
                  name: "post-build-image-automated-approver"
                  annotations:
                    description: "Builds the image for the automated-approver plugin."
                    owner: "neighbors"
                  run_if_changed: '^development/external-plugins/automated-approver'
                  args:
                    - "--name=test-infra/automated-approver"
                    - "--config=/config/kaniko-build-config.yaml"
                    - "--context=."
                    - "--dockerfile=development/external-plugins/automated-approver/Dockerfile"
                inheritedConfigs:
                  global:
                    - "kaniko_buildpack"
                    - "jobConfig_postsubmit"
