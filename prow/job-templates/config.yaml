global:
  releases:
    - '1.4'
    - '1.3'
    - '1.2'

go_buildpack_v20181119: &go_buildpack_v20181119 eu.gcr.io/kyma-project/prow/test-infra/buildpack-golang:v20181119-afd3fbd
go_buildpack_1_11: &go_buildpack_1_11 eu.gcr.io/kyma-project/test-infra/buildpack-golang:go1.11
go_buildpack_1_12: &go_buildpack_1_12 eu.gcr.io/kyma-project/test-infra/buildpack-golang:go1.12
kubebuilder_buildpack_v20190208: &kubebuilder_buildpack_v20190208 eu.gcr.io/kyma-project/test-infra/buildpack-golang-kubebuilder:v20190208-813daef
bootstrap_buildpack_v20181121: &bootstrap_buildpack_v20181121 eu.gcr.io/kyma-project/prow/test-infra/bootstrap:v20181121-f3ea5ce

kyma_component: &kyma_component
  repository: github.com/kyma-project/kyma
  preset: build

go_kyma_component_1_11: &go_kyma_component_1_11
  <<: *kyma_component
  buildpack: *go_buildpack_1_11

go_kyma_component_1_12: &go_kyma_component_1_12
  <<: *kyma_component
  buildpack: *go_buildpack_1_12

kubebuilder_kyma_component: &kubebuilder_kyma_component
  <<: *kyma_component
  buildpack: *kubebuilder_buildpack_v20190208
  resources:
    memory: 2.5Gi
    cpu: 2

bootstrap_kyma_component: &bootstrap_kyma_component
  <<: *kyma_component
  buildpack: *bootstrap_buildpack_v20181121

go_kyma_component_v20181119: &go_kyma_component_v20181119
  <<: *kyma_component
  buildpack: *go_buildpack_v20181119

templates:
  - from: templates/kyma-integration.yaml
    render:
      - to: ../jobs/kyma/kyma-integration.yaml
  - from: templates/kyma-artifacts.yaml
    render:
      - to: ../jobs/kyma/kyma-artifacts.yaml
  - from: templates/kyma-installer.yaml
    render:
      - to: ../jobs/kyma/kyma-installer.yaml
  - from: templates/component.yaml
    render:
      - to: ../jobs/kyma/components/api-controller/api-controller.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/api-controller
      - to: ../jobs/kyma/components/apiserver-proxy/apiserver-proxy.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/apiserver-proxy
      - to: ../jobs/kyma/tests/acceptance/acceptance.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/acceptance
      - to: ../jobs/kyma/components/application-broker/application-broker.yaml
        values:
          <<: *go_kyma_component_1_11
          path: components/application-broker
      - to: ../jobs/kyma/components/application-connectivity-certs-setup-job/application-connectivity-certs-setup-job.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/application-connectivity-certs-setup-job
      - to: ../jobs/kyma/components/application-connectivity-validator/application-connectivity-validator.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/application-connectivity-validator
      - to: ../jobs/kyma/components/application-gateway/application-gateway.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/application-gateway
      - to: ../jobs/kyma/components/application-registry/application-registry.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/application-registry
      - to: ../jobs/kyma/components/asset-metadata-service/asset-metadata-service.yaml
        values:
          <<: *go_kyma_component_1_11
          path: components/asset-metadata-service
      - to: ../jobs/kyma/components/asset-store-controller-manager/asset-store-controller-manager.yaml
        values:
          <<: *go_kyma_component_1_11
          path: components/asset-store-controller-manager
      - to: ../jobs/kyma/components/asset-upload-service/asset-upload-service.yaml
        values:
          <<: *go_kyma_component_1_11
          path: components/asset-upload-service
      - to: ../jobs/kyma/components/cms-controller-manager/cms-controller-manager.yaml
        values:
          <<: *kubebuilder_kyma_component
          path: components/cms-controller-manager
      - to: ../jobs/kyma/components/cms-services/cms-services.yaml
        values:
          <<: *go_kyma_component_1_12
          path: components/cms-services
      - to: ../jobs/kyma/components/compass-runtime-agent/compass-runtime-agent.yaml
        values:
          <<: *go_kyma_component_1_11
          path: components/compass-runtime-agent
      - to: ../jobs/kyma/components/connection-token-handler/connection-token-handler.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/connection-token-handler
      - to: ../jobs/kyma/components/connectivity-certs-controller/connectivity-certs-controller.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/connectivity-certs-controller
      - to: ../jobs/kyma/components/connector-service/connector-service.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/connector-service
      - to: ../jobs/kyma/components/console-backend-service/console-backend-service.yaml
        values:
          <<: *go_kyma_component_1_11
          path: components/console-backend-service
      - to: ../jobs/kyma/components/dex-static-user-configurer/dex-static-user-configurer.yaml
        values:
          <<: *bootstrap_kyma_component
          path: components/dex-static-user-configurer
      - to: ../jobs/kyma/components/etcd-tls-setup-job/etcd-tls-setup-job.yaml
        values:
          <<: *go_kyma_component_1_11
          path: components/etcd-tls-setup-job
      - to: ../jobs/kyma/components/event-bus/event-bus.yaml
        values:
          <<: *go_kyma_component_1_11
          path: components/event-bus
      - to: ../jobs/kyma/components/event-service/event-service.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/event-service
      - to: ../jobs/kyma/components/helm-broker/helm-broker.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/helm-broker
      - to: ../jobs/kyma/components/iam-kubeconfig-service/iam-kubeconfig-service.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/iam-kubeconfig-service
      - to: ../jobs/kyma/components/istio-kyma-patch/istio-kyma-patch.yaml
        values:
          <<: *bootstrap_kyma_component
          path: components/istio-kyma-patch
      - to: ../jobs/kyma/components/k8s-dashboard-proxy/k8s-dashboard-proxy.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/k8s-dashboard-proxy
      - to: ../jobs/kyma/components/knative-function-controller/knative-function-controller.yaml
        values:
          <<: *kubebuilder_kyma_component
          path: components/knative-function-controller
      - to: ../jobs/kyma/components/kubeless-images/kubeless-images.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/kubeless-images
      - to: ../jobs/kyma/components/kyma-operator/kyma-operator.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/kyma-operator
      - to: ../jobs/kyma/components/namespace-controller/namespace-controller.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/namespace-controller
      - to: ../jobs/kyma/components/service-binding-usage-controller/service-binding-usage-controller.yaml
        values:
          <<: *go_kyma_component_1_11
          path: components/service-binding-usage-controller
      - to: ../jobs/kyma/components/xip-patch/xip-patch.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: components/xip-patch
      - to: ../jobs/kyma/tests/acceptance/acceptance.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/acceptance
      - to: ../jobs/kyma/tests/application-connector-tests/application-connector-tests.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/application-connector-tests
      - to: ../jobs/kyma/tests/application-gateway-tests/application-gateway-tests.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/application-gateway-tests
      - to: ../jobs/kyma/tests/application-operator-tests/application-operator-tests.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/application-operator-tests
      - to: ../jobs/kyma/tests/application-registry-tests/application-registry-tests.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/application-registry-tests
      - to: ../jobs/kyma/tests/asset-store/asset-store.yaml
        values:
          <<: *go_kyma_component_1_11
          path: tests/asset-store
      - to: ../jobs/kyma/tests/compass-runtime-agent/compass-runtime-agent.yaml
        values:
          <<: *go_kyma_component_1_11
          path: tests/compass-runtime-agent
      - to: ../jobs/kyma/tests/connection-token-handler-tests/connection-token-handler-tests.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/connection-token-handler-tests
      - to: ../jobs/kyma/tests/connector-service-tests/connector-service-tests.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/connector-service-tests
      - to: ../jobs/kyma/tests/console-backend-service/console-backend-service.yaml
        values:
          <<: *go_kyma_component_1_11
          path: tests/console-backend-service
      - to: ../jobs/kyma/tests/event-bus/event-bus.yaml
        values:
          <<: *go_kyma_component_1_11
          path: tests/event-bus
      - to: ../jobs/kyma/tests/knative-build/knative-build.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/knative-build
      - to: ../jobs/kyma/tests/knative-serving/knative-serving.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/knative-serving
      - to: ../jobs/kyma/tests/kubeless/kubeless.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/kubeless
      - to: ../jobs/kyma/tests/test-namespace-controller/test-namespace-controller.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/test-namespace-controller
      - to: ../jobs/kyma/tests/integration/api-controller/api-controller.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/integration/api-controller
      - to: ../jobs/kyma/tests/integration/apiserver-proxy/apiserver-proxy.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/integration/apiserver-proxy
      - to: ../jobs/kyma/tests/integration/dex/dex.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/integration/dex
      - to: ../jobs/kyma/tests/integration/event-service/event-service.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/integration/event-service
      - to: ../jobs/kyma/tests/integration/gateway/gateway.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/integration/gateway
      - to: ../jobs/kyma/tests/integration/logging/logging.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/integration/logging
          since: '1.4'
      - to: ../jobs/kyma/tests/logging/logging.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/logging
          until: '1.3'
      - to: ../jobs/kyma/tests/integration/monitoring/monitoring.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/integration/monitoring
          since: '1.4'
      - to: ../jobs/kyma/tests/monitoring/monitoring.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tests/monitoring
          until: '1.3'
      - to: ../jobs/kyma/tests/integration/cluster-users/cluster-users.yaml
        values:
          <<: *bootstrap_kyma_component
          path: tests/integration/cluster-users
          resources:
            cpu: 0.2
            memory: 256Mi
      - to: ../jobs/kyma/components/xip-patch/xip-patch.yaml
        values:
          <<: *bootstrap_kyma_component
          path: components/xip-patch
      - to: ../jobs/kyma/components/asset-store-controller-manager/asset-store-controller-manager.yaml
        values:
          <<: *kubebuilder_kyma_component
          path: components/asset-store-controller-manager
      - to: ../jobs/console/core/core.yaml
        values:
          repository: github.com/kyma-project/console
          path: core
          preset: build-console
          noRelease: yes
          resources:
            cpu: 1.5
            memory: 2Gi
          buildpack: eu.gcr.io/kyma-project/prow/test-infra/buildpack-node-chromium:v20181207-d46c013
      - to: ../jobs/test-infra/watch-pods.yaml
        values:
          repository: github.com/kyma-project/test-infra
          path: watch-pods
          preset: build
          buildpack: eu.gcr.io/kyma-project/test-infra/buildpack-golang:go1.11
      - to: ../jobs/kyma/tools/alpine-net/alpine-net.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tools/alpine-net
      - to: ../jobs/kyma/tools/load-test/load-test.yaml
        values:
          <<: *go_kyma_component_v20181119
          path: tools/load-test
