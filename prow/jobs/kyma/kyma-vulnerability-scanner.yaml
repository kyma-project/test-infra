test_infra_ref: &test_infra_ref
  org: kyma-project
  repo: test-infra
  path_alias: github.com/kyma-project/test-infra

kyma_ref: &kyma_ref
  org: kyma-project
  repo: kyma
  path_alias: github.com/kyma-project/kyma

periodics:
- name: kyma-vulnerabilites-scan
  cron: "0 6 * * 1" # "At 06:00 on Monday."
  labels:
    preset-sap-slack-bot-token: "true"
    preset-kyma-snyk-token: "true"
  decorate: true
  extra_refs:
    - <<: *test_infra_ref
      base_ref: master
    - <<: *kyma_ref
      base_ref: master
  spec:
    containers:
      - image: eu.gcr.io/kyma-project/test-infra/vulnerability-scanner:v20190226-14fa550
        command:
          - "bash"
        env:
          - name: KYMA_PROJECT_DIR
            value: "/home/prow/go/src/github.com/kyma-project"
        args:
          - "-c"
          - "${KYMA_PROJECT_DIR}/test-infra/development/vulnerabilities-scanner.sh"
        resources:
          requests:
            memory: 100Mi
            cpu: 50m
- name: kyma-gcp-container-vulnerability-collector
  decorate: true
  cron: "0 0 1 * *" # “At 00:00 on day-of-month 1.”
  labels:
    preset-sap-slack-bot-token: "true"
    preset-kyma-slack-channel: "true"
  spec:
    containers:
      - image: eu.gcr.io/kyma-project/prow/test-infra/bootstrap:v20181121-f3ea5ce
        command:
          - "bash"
        env:
          - name: KYMA_PROJECT_DIR
            value: "/home/prow/go/src/github.com/kyma-project"
        args:
          - "-c"
          - "${KYMA_PROJECT_DIR}/test-infra/development/container-vulnerabilities.sh -project=kyma-project -region=eu"
        resources:
          requests:
            memory: 10Mi
            cpu: 100m