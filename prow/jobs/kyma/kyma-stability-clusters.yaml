gke_job_labels_template: &gke_job_labels_template
  preset-sa-gke-kyma-integration: "true"
  preset-gc-compute-envs: "true"
  preset-gc-project-env: "true"
  preset-docker-push-repository-gke-integration: "true"
  preset-dind-enabled: "true"
  preset-kyma-artifacts-bucket: "true"

test_infra_ref: &test_infra_ref
  org: kyma-project
  repo: test-infra
  path_alias: github.com/kyma-project/test-infra

kyma_ref: &kyma_ref
  org: kyma-project
  repo: kyma
  path_alias: github.com/kyma-project/kyma

periodics:
- name: kyma-gke-nightly
  cron: "0 8-16/3 * * 1-5" # At minute 0 past every 3rd hour from 8 through 16 on every day-of-week from Monday through Friday.
  labels:
    preset-slack-notifications: "true"
    <<: *gke_job_labels_template
  decorate: true
  extra_refs:
  - <<: *test_infra_ref
    base_ref: master
  - <<: *kyma_ref
    base_ref: master
  spec:
    containers:
    - image: eu.gcr.io/kyma-project/prow/test-infra/bootstrap-helm:v20181121-f2f12bc
      securityContext:
        privileged: true
      command:
      - "bash"
      args:
      - "-c"
      - "${KYMA_PROJECT_DIR}/test-infra/prow/scripts/cluster-integration/kyma-gke-nightly.sh"
      resources:
        requests:
          memory: 200Mi
          cpu: 80m
