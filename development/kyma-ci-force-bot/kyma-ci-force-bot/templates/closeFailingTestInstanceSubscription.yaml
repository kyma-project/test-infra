apiVersion: eventing.kyma-project.io/v1alpha1
kind: Subscription
metadata:
  name: {{ .Release.Name }}-{{ .Values.closeFailingInstance.eventType }}-{{ .Values.closeFailingInstance.eventAction }}
  namespace: {{ .Release.Namespace }}
  labels:
    app: {{ .Values.appName | quote }}
    release: {{ .Release.Name | quote }}
    service: {{ .Values.closeFailingInstance.name | quote }}
    event: {{ .Values.closeFailingInstance.eventType | quote }}
    action: {{ .Values.closeFailingInstance.eventAction | quote }}
spec:
  filter:
    filters:
    - eventSource:
        property: source
        type: exact
        value: ""
      eventType:
        property: type
        type: exact
        value: sap.kyma.custom.{{ .Values.appName | replace "-" "" }}.{{ .Values.closeFailingInstance.eventType }}.{{ .Values.closeFailingInstance.eventAction }}.{{ .Values.closeFailingInstance.eventVersion }}
  protocol: ""
  protocolsettings: {}
  sink: http://{{ .Release.Name}}-{{ .Values.closeFailingInstance.name }}.{{ .Release.Namespace }}.svc.cluster.local
